<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TG3F4YGJW1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag("js", new Date());

        gtag("config", "G-TG3F4YGJW1");
    </script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta property="og:title" content="Ruby Arcade" />
    <meta property="og:description" content="Ruby arcade is a game network that features a wide variety of engaging and immersive games suitable for all ages." />
    <meta property="og:image" content="https://rubyarcade.lol/media/icons/metapicture.png" />
    
    <title>Games</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet"/>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet"/>
    <link rel="icon" type="image/x-icon" href="/media/icons/favicon.ico" />

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2XEFG8CYTH"></script>


    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/loader.css">

<style>
    h3 {

        margin-left: 10vh;
        font-weight: 400;
    }
</style>


</head>

<body>
    <div class="navbar">
        <span class="logo-span">
            <button class="logo" onclick="window.location.href='index.html'">
                <img
                    src="media/icons/rubyarcade.png"
                    alt="Ruby Games Logo"
                    class="logo"
                    width="125vh"
                    height="27vh"
                />
            </button>
        </span>
        
        <div class="navbar-right">
            <button class="nav-button" onclick="window.location.href='index.html'">
                <span>Home</span>
            </button>
            <button class="nav-button" onclick="window.location.href='games.html'">
                <span>Games</span>
            </button>
            <button class="nav-button" onclick="window.location.href='apps.html'">
                <span>Apps</span>
            </button>
            <button class="nav-button" onclick="window.location.href='utilities.html'">
                <span>Utilities</span>
            </button>
            <button style="margin-right: 20vh;"" class="nav-button" onclick="window.location.href='search.html'">
                <span">Search</span>
            </button>
        </div>
    </div>
    


    <header>Games</header>
    <h3>click <a href=https://rubyarcadegames.onrender.com/>here</a> for all the games</h3>
    <div class="container">

        <div class="input-container">
            <input class="text" id="searchInput" onkeyup="searchGames()" placeholder="Search 340+ Games"/>
        </div>

        <div class="dropdown-container">

          <img class="dropdown-image" src="media/icons/filter.png" alt="Dropdown Icon">
          <select class="dropdown">
            <option value="all">Filter - All</option>
            <option value="Horror">Horror</option>
            <option value="Idle">Idle</option>
            <option value="Point and Click">Point and click</option>
            <option value="Sandbox">Sandbox</option>
            <option value="Adventure">Adventure</option>
            <option value="Social">Social</option>
            <option value="Sports">Sports</option>
            <option value="Racing">Racing</option>
            <option value="Battle Royale">Battle Royale</option>
            <option value="Shooter">Shooter</option>
            <option value="Platformer">Platformer</option>
            <option value="Rhythm">Rhythm</option>
            <option value="Puzzle">Puzzle</option>
            <option value="Arcade">Arcade</option>
            <option value="Multiplayer">Multiplayer</option>
            <option value="Simulation">Simulation</option>
            <option value="Driving">Driving</option>
            <option value="Endless Runner">Endless Runner</option>
            <option value="Action">Action</option>
            <option value="Casual">Casual</option>
            <option value="Educational">Educational</option>
            <option value="Role-Playing">Role-Playing</option>
            <option value="Management">Management</option>
            <option value="Tower Defense">Tower Defense</option>            
          </select>
          
        </div>
        <div class="suggest-container">
            <img class="suggest-image" src="media/icons/chat.png" alt="Dropdown Icon">
            
            <a href="https://forms.gle/nwikE72j2wJbAfRn8" target="_blank"><button class="suggest"></button></a>

        </div>
        
      </div>



 





<div id="favoriteGames" style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center; margin-bottom: 50px;">

</div>

    <div id="gamesList" style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center;">
        

  </div>


    <!-- Game loader section -->
    <section id="gameLoaderSection" style="display: none;">
        <div id="gameLoaderContainer">
            
            <iframe id="gameFrame" src="media/icons/loading.gif" frameborder="0">
                
            </iframe>
            
        </div>
        <div class="gameBar">
            <div class="gameBarButton" onclick="removeGameLoader()">
                <img src="/media/icons/remove.png" width="20px" alt="Remove Game Loader" />
            </div>
            <img src="/media/icons/ruby.png" width="20px" />
            <div class="button-group">
                <div class="gameBarButton" onclick="refreshGame()">
                    <img src="/media/icons/refresh.png" width="20px" alt="Refresh" />
                </div>
                <div class="gameBarButton" onclick="toggleFullscreen()">
                    <img src="/media/icons/fullscreen.png" width="20px" alt="Fullscreen" />
                </div>
            </div>
        </div>
    </section>

    <center>
        <h6>Games on this site are for entertainment purposes only. All rights belong to their respective owners.</h6>
    </center>

    <script src="/js/loader.js"></script>
    <script src="/js/button.js"></script>
    <script src="/js/search.js"></script>
    <script src="assets/games.js"></script>

    <script>

        // hover
        function applyHoverEffect(button) {
            button.addEventListener('mousemove', e => {
                const rect = button.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                const deltaX = (x - centerX) / centerX;
                const deltaY = (y - centerY) / centerY;
                const offsetX = deltaX * 10; 
                const offsetY = deltaY * 10; 
                const scale = 1.2;
                const img = button.querySelector('img');
                img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
                button.style.backgroundImage = `radial-gradient(circle at ${x}px ${y}px, rgba(255, 255, 255, 0) 0%, rgba(0, 0, 0, 0.8) 100%)`;
            });
        
            button.addEventListener('mouseleave', () => {
                const img = button.querySelector('img');
                img.style.transform = 'translate(0, 0) scale(1)';
                button.style.backgroundImage = '';
            });
        }
        
        function insertGamesIntoPage(games) {
    // Sort games alphabetically by name
    games.sort((a, b) => a.name.localeCompare(b.name));
    
    // Move favorited games to the beginning of the list
    const favoritedGames = games.filter(game => game.favorited); // Assuming you have a 'favorited' property in your game objects
    const nonFavoritedGames = games.filter(game => !game.favorited);
    games = [...favoritedGames, ...nonFavoritedGames];
    
    var gamesContainer = document.getElementById("gamesList");
    if (gamesContainer) {
        gamesContainer.innerHTML = ""; // Clear the container first
        
    
        games.forEach(function(game) {
            var gameHTML = generateGameHTML(game);
            gamesContainer.innerHTML += gameHTML;
        });
    
        const buttons = document.querySelectorAll('.btn-hover');
        buttons.forEach(button => {
            applyHoverEffect(button);
        });
    }
}
        
        
        function generateGameHTML(game) {
    return `
        <div class="btn btn-hover" onclick="loadGame('${game.playUrl}')" onmouseover="applyHoverEffect(this)" ">
            <button class="btn-favorite" onclick="favoriteGame(event)">&#9733;</button>
            <img src="${game.imageUrl}" />
            <span>${game.name}</span>
        </div>
        
    `;
}


function updateLocalStorage() {
    // Get all favorited game buttons
    const favoritedButtons = document.querySelectorAll('.btn-favorite.favorited');

    // Extract the HTML of each favorited game button
    const favoritedGamesHTML = new Set(); // Using a Set to ensure uniqueness
    favoritedButtons.forEach(button => {
        const gameHTML = button.parentElement.outerHTML;
        favoritedGamesHTML.add(gameHTML);
    });

    // Save the list of favorited game HTML in localStorage
    localStorage.setItem('favoriteGamesHTML', JSON.stringify(Array.from(favoritedGamesHTML)));
}

document.addEventListener('DOMContentLoaded', function() {
    // Retrieve favorited games HTML from localStorage
    const favoritedGamesHTML = JSON.parse(localStorage.getItem('favoriteGamesHTML'));

    // Get the favorite games container
    const favoriteGamesContainer = document.getElementById('favoriteGames');

    // If there are favorited games stored in localStorage, display them
    if (favoritedGamesHTML) {
        favoritedGamesHTML.forEach(gameHTML => {
            const gameElement = document.createElement('div');
            gameElement.innerHTML = gameHTML;
            favoriteGamesContainer.appendChild(gameElement.firstChild);
        });
    }
});

function favoriteGame(event) {
    // Prevent the default behavior of the button (e.g., submitting a form)
    event.preventDefault();
    event.stopPropagation();

    // Toggle a class on the button to visually indicate it's been favorited
    event.target.classList.toggle('favorited');

    // Find the parent game element
    const gameElement = event.target.closest('.btn');

    // Get the favorite games container
    const favoriteGamesContainer = document.getElementById('favoriteGames');

    if (gameElement.parentElement === favoriteGamesContainer) {
        // If the game element is already in the favorite games container, remove it
        favoriteGamesContainer.removeChild(gameElement);
    } else {
        // Clone the game element
        const clonedGameElement = gameElement.cloneNode(true);
        // Remove the 'favorited' class from the cloned element to avoid duplication
        clonedGameElement.classList.remove('favorited');
        
        // Remove the favorite button from the cloned game element
        const favoriteButton = clonedGameElement.querySelector('.btn-favorite');
        if (favoriteButton) {
            favoriteButton.remove();
        }

        // Insert the cloned game element at the top of the favorite games container
        favoriteGamesContainer.prepend(clonedGameElement);
    }

    // Update localStorage
    updateLocalStorage();
}



        

        fetch('assets/data/games.json')
    .then(response => response.json())
    .then(data => {
        // Store the loaded games data in the gamesData variable
        gamesData = data;
        
        // Insert all games into the page initially
        insertGamesIntoPage(gamesData);
    })
    .catch(error => {
        console.error('Error loading the JSON file:', error);
    });

            const dropdown = document.querySelector('.dropdown');

            function filterGamesByGenre(genre) {
    // If genre is 'all', display all games
    if (genre === 'all') {
        insertGamesIntoPage(gamesData);
    } else {
        // Filter games based on genre
        const filteredGames = gamesData.filter(game => game.genres.includes(genre));
        insertGamesIntoPage(filteredGames);
    }
}

// Event listener to trigger filtering when dropdown value changes
dropdown.addEventListener('change', function() {
    const selectedGenre = this.value;
    filterGamesByGenre(selectedGenre);
});
        </script>
        
</body>
</html>
